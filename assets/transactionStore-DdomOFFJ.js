import{G as T,r as c,u as N,a as P,s as f,H as o}from"./index-Hxr7AJ_R.js";import{u as b}from"./mainStore-Df_xSuYx.js";const J=T("transaction",()=>{const r=c(!1),u=c([]),i=c([]),l=c([]),p=c(null),g=N(),v=c(""),y=b(),m=P(),{contest:h}=f(y),{user:d}=f(m);async function _(s,n){var t,e;try{if(r.value=!0,!s||isNaN(s)||s<=0)throw new Error("Invalid amount. Please enter a valid positive number.");const a=await o.post("/funds/transaction",{action:"deposit",amount:s,transaction_id:n});return r.value=!1,{success:a.data.success,message:a.data.message}}catch(a){return r.value=!1,console.error("Error Adding Fund:",a),{success:!1,message:((e=(t=a.response)==null?void 0:t.data)==null?void 0:e.message)||"An unexpected error occurred"}}}async function w(s){var n,t;try{r.value=!0;const e=await o.post("/razorpay/order/create",{amount:s});console.log("response data:",e.data.data);const a={key:e.data.data.key,amount:e.data.data.amount,currency:e.data.data.currency,name:"Himpri",description:"Order Payment",order_id:e.data.data.order_id,handler:function(G){M(G)},prefill:{name:d.value.name,email:d.value.email,contact:d.value.mobile},theme:{color:"#3399cc"}};return new Razorpay(a).open(),r.value=!1,{success:e.data.success,message:e.data.message}}catch(e){return r.value=!1,console.error("Error Adding Fund:",e),{success:!1,message:((t=(n=e.response)==null?void 0:n.data)==null?void 0:t.message)||"An unexpected error occurred"}}}async function M(s){var n,t;try{r.value=!0;const e=await o.post("razorpay/payment/verify",{razorpay_payment_id:s.razorpay_payment_id,razorpay_order_id:s.razorpay_order_id,razorpay_signature:s.razorpay_signature});return result.data.success?g.success(e.data.message):g.error(e.data.message),r.value=!1,{success:e.data.success,message:e.data.message}}catch(e){return r.value=!1,console.error("Error Adding Fund:",e),{success:!1,message:((t=(n=e.response)==null?void 0:n.data)==null?void 0:t.message)||"An unexpected error occurred"}}}async function A(s){var n,t;try{if(r.value=!0,!s||isNaN(s)||s<=0)throw new Error("Invalid amount. Please enter a valid positive number.");const e=await o.post("/funds/transaction",{action:"withdraw",amount:s});return r.value=!1,{success:e.data.success,message:e.data.message}}catch(e){return r.value=!1,console.error("Error Withdrawing Fund:",e),{success:!1,message:((t=(n=e.response)==null?void 0:n.data)==null?void 0:t.message)||"An unexpected error occurred"}}}async function z(s){var n,t;try{r.value=!0;const e=await o.post("/play/quiz/join",{node_id:h.value.node_id,variant_id:s});return m.fetchUser(),r.value=!1,{success:e.data.success,message:e.data.message}}catch(e){return r.value=!1,console.error("Error Joining Game:",e),{success:!1,message:((t=(n=e.response)==null?void 0:n.data)==null?void 0:t.message)||"An unexpected error occurred"}}}async function E(s=1){var n,t;try{r.value=!0;const e={page:s},a=await o.get("/funds/transaction/list",{params:e});return s===1?u.value=a.data.data.transactions:u.value=[...u.value,...a.data.data.transactions],r.value=!1,{success:a.data.success,message:a.data.message,pagination:a.data.data.totalCount>u.value.length}}catch(e){return r.value=!1,console.error("Error getting transactions:",e),{success:!1,message:((t=(n=e.response)==null?void 0:n.data)==null?void 0:t.message)||"An unexpected error occurred"}}}async function x(s=1){var n,t;try{const e={page:s};r.value=!0;const a=await o.get("/lifeline/transaction/list",{params:e});return s===1?i.value=a.data.data.lifeline_transactions:i.value=[...i.value,...a.data.data.lifeline_transactions],r.value=!1,{success:a.data.success,message:a.data.message,pagination:a.data.data.totalCount>i.value.length}}catch(e){return r.value=!1,console.error("Error Joining Game:",e),{success:!1,message:((t=(n=e.response)==null?void 0:n.data)==null?void 0:t.message)||"An unexpected error occurred"}}}async function F(s=1){var n,t;try{r.value=!0;const e={page:s},a=await o.get("/lifeline/history/list",{params:e});return s===1?l.value=a.data.data.lifeline_histories:l.value=[...l.value,...a.data.data.lifeline_histories],r.value=!1,{success:a.data.success,message:a.data.message,pagination:a.data.data.totalCount>l.value.length}}catch(e){return r.value=!1,console.error("Error Joining Game:",e),{success:!1,message:((t=(n=e.response)==null?void 0:n.data)==null?void 0:t.message)||"An unexpected error occurred"}}}return{getTransactions:E,getLifelineTransactions:x,getLifelineHistories:F,payWithRazorpay:w,withdrawFunds:A,addFunds:_,joinGame:z,fundAction:v,loading:r,error:p,transactions:u,lifeline_transactions:i,lifeline_histories:l}});export{J as u};

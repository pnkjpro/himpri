import{r as g,s as $,v as P,a3 as J,o as q,c as n,b as e,t as c,h as v,y as K,z as E,A as z,f as p,u as b,F as G,d as Q,j as i}from"./index-6Xq51A_u.js";import{u as W}from"./adminStore-DOg9xTvn.js";import{u as X}from"./mainStore-CqMG1ygd.js";const Y={class:"min-h-screen bg-gray-50 py-8"},Z={class:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8"},ee={class:"grid grid-cols-1 lg:grid-cols-2 gap-8"},te={class:"bg-white rounded-lg shadow-md p-6"},oe={class:"flex items-center justify-between mb-6"},se={class:"text-xl font-semibold text-gray-900"},re={class:"space-y-3"},le={key:0,class:"p-4 bg-gray-50 rounded-lg border border-gray-200"},ne={class:"flex items-center space-x-3"},ie={class:"flex-shrink-0"},ae=["src","alt"],de={class:"flex-1"},ue={class:"text-sm text-gray-600"},ce={class:"font-medium"},me={class:"flex items-center space-x-3"},ge={class:"flex items-center justify-center px-4 py-2 border border-gray-300 rounded-md shadow-sm bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 cursor-pointer transition-colors"},ve={class:"text-sm text-gray-600"},pe={key:1,class:"p-4 bg-blue-50 rounded-lg border border-blue-200"},fe={class:"flex items-center space-x-3"},ye={class:"flex-shrink-0"},be=["src","alt"],xe={class:"flex justify-end space-x-3 pt-4"},he=["disabled"],we={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white inline",fill:"none",viewBox:"0 0 24 24"},ke={class:"bg-white rounded-lg shadow-md p-6"},Ce={class:"space-y-3 max-h-96 overflow-y-auto"},_e={class:"flex items-center space-x-3"},je={class:"flex items-center space-x-3"},Me={class:"flex-shrink-0"},Be=["src","alt"],Ee={key:1,class:"w-10 h-10 bg-gray-200 rounded-lg flex items-center justify-center"},ze={class:"flex items-center justify-center w-8 h-8 bg-blue-100 text-blue-800 text-sm font-medium rounded-full"},Ae={class:"font-medium text-gray-900"},Fe={key:0,class:"text-sm text-gray-500"},Ie={class:"flex items-center space-x-2"},Se={class:"flex space-x-1"},Ne=["onClick","disabled"],De=["onClick","disabled"],Le={class:"flex space-x-1"},Te=["onClick"],Ve=["onClick"],Oe={class:"mt-6 pt-4 border-t border-gray-200"},He=["disabled"],Ue={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white inline",fill:"none",viewBox:"0 0 24 24"},Re={key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50 flex items-center justify-center"},$e={class:"relative bg-white rounded-lg shadow-xl max-w-md w-full mx-4"},Pe={class:"p-6"},Je={class:"text-center"},qe={class:"text-sm text-gray-500 mb-4"},Ke={class:"font-medium"},Ge={class:"flex justify-end space-x-3"},Qe=["disabled"],We={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white inline",fill:"none",viewBox:"0 0 24 24"},tt={__name:"CreateCategory",setup(Xe){const k={name:"",description:"",icon:"",display_order:1},s=g({...k}),C=g({...k}),a=g(!1),M=g(null),_=g(!1),h=g(null),x=g(null),j=g(null),B=()=>{Object.assign(s.value,JSON.parse(JSON.stringify(k))),Object.assign(C.value,JSON.parse(JSON.stringify(k))),a.value=!1,M.value=null,x.value=null,j.value=null;const o=document.getElementById("icon");o&&(o.value="")},A=()=>{B()},d=W(),w=X(),{categories:F}=$(w),u=P(),f=g([]);J(F,o=>{f.value=Array.isArray(o)?[...o]:[]},{immediate:!0});const I=o=>{if(o>0){const t=f.value;[t[o-1],t[o]]=[t[o],t[o-1]]}},S=o=>{if(o<f.value.length-1){const t=f.value;[t[o],t[o+1]]=[t[o+1],t[o]]}},N=async()=>{const o=f.value.map((l,r)=>({id:l.id,display_order:r+1}));(await d.updateCategorySorting(o)).success?(u.success("Category order updated!"),w.fetchCategories()):u.error("Failed to update sorting.")},D=o=>{C.value={name:o.name,description:o.description||"",icon:o.icon||"",display_order:o.display_order||1},s.value={name:o.name,description:o.description||"",icon:"",display_order:o.display_order||1},a.value=!0,M.value=o.id,j.value=o.icon||null,x.value=null;const t=document.getElementById("icon");t&&(t.value=""),window.scrollTo({top:0,behavior:"smooth"})},L=o=>{h.value=o,_.value=!0},T=async()=>{if(!h.value)return;const o=await d.deleteCategory(h.value.id);o.success?(u.success(o.message||"Category deleted successfully!"),w.fetchCategories()):u.error(o.message||"Failed to delete category."),_.value=!1,h.value=null};q(()=>{w.fetchCategories()});const V=o=>{const t=o.target.files[0];if(t){if(t.size>200*1024){u.error("File size should not exceed 200KB"),o.target.value="";return}s.value.iconFile=t,s.value.icon=t.name;const l=new FileReader;l.onload=r=>{x.value=r.target.result},l.readAsDataURL(t)}},O=()=>{x.value=null,s.value.iconFile=null,s.value.icon="";const o=document.getElementById("icon");o&&(o.value="")},H=o=>{o.target.style.display="none"},U=async()=>{const o=new FormData;if(a.value){if(C.value.name!==s.value.name&&o.append("name",s.value.name),C.value.description!==s.value.description&&o.append("description",s.value.description),s.value.iconFile&&o.append("icon",s.value.iconFile),!o.has("name")&&!o.has("description")&&!o.has("icon")){u.info("No changes detected");return}}else o.append("name",s.value.name),o.append("description",s.value.description),s.value.iconFile&&o.append("icon",s.value.iconFile);let t;if(a.value?t=await d.updateCategory(M.value,o):t=await d.createCategory(o),!t.success){const l=t.message;typeof l=="object"&&l!==null&&!Array.isArray(l)?Object.values(l).forEach((r,m)=>{r.forEach((y,R)=>{setTimeout(()=>u.error(y),(m+R)*300)})}):Array.isArray(l)?l.forEach((r,m)=>{setTimeout(()=>u.error(r),m*300)}):u.error(l);return}u.success(t.message||`Category ${a.value?"updated":"created"} successfully!`),B(),w.fetchCategories()};return(o,t)=>{var l;return i(),n("div",Y,[e("div",Z,[t[24]||(t[24]=e("div",{class:"mb-8"},[e("h1",{class:"text-3xl font-bold text-gray-900"},"Category Management"),e("p",{class:"mt-2 text-gray-600"},"Create, edit, and manage quiz categories")],-1)),e("div",ee,[e("div",te,[e("div",oe,[e("h2",se,c(a.value?"Edit Category":"Add New Category"),1),a.value?(i(),n("button",{key:0,onClick:A,class:"text-gray-500 hover:text-gray-700 transition-colors"},t[4]||(t[4]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))):v("",!0)]),e("form",{onSubmit:K(U,["prevent"]),class:"space-y-6"},[e("div",null,[t[5]||(t[5]=e("label",{for:"name",class:"block text-sm font-medium text-gray-700 mb-2"}," Category Name * ",-1)),E(e("input",{id:"name","onUpdate:modelValue":t[0]||(t[0]=r=>s.value.name=r),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Enter category name",required:""},null,512),[[z,s.value.name]])]),e("div",null,[t[6]||(t[6]=e("label",{for:"description",class:"block text-sm font-medium text-gray-700 mb-2"}," Description ",-1)),E(e("textarea",{id:"description","onUpdate:modelValue":t[1]||(t[1]=r=>s.value.description=r),class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors resize-none",rows:"3",placeholder:"Enter category description"},null,512),[[z,s.value.description]])]),e("div",null,[t[14]||(t[14]=e("label",{for:"icon",class:"block text-sm font-medium text-gray-700 mb-2"}," Category Icon ",-1)),e("div",re,[a.value&&j.value?(i(),n("div",le,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Current Icon",-1)),e("div",ne,[e("div",ie,[e("img",{src:j.value,alt:s.value.name,class:"w-16 h-16 object-cover rounded-lg border border-gray-300",onError:H},null,40,ae)]),e("div",de,[e("p",ue,[t[7]||(t[7]=p(" Current icon for ")),e("span",ce,c(s.value.name),1)]),t[8]||(t[8]=e("p",{class:"text-xs text-gray-500 mt-1"}," Upload a new icon below to replace this one ",-1))])])])):v("",!0),e("div",me,[e("label",ge,[t[10]||(t[10]=e("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})],-1)),p(" "+c(a.value?"Choose New Icon":"Choose File")+" ",1),e("input",{id:"icon",type:"file",onChange:V,class:"hidden",accept:"image/*"},null,32)]),e("span",ve,c(s.value.icon||"No file chosen"),1)]),x.value?(i(),n("div",pe,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-blue-700 mb-2"},"New Icon Preview",-1)),e("div",fe,[e("div",ye,[e("img",{src:x.value,alt:"Preview of "+s.value.name,class:"w-16 h-16 object-cover rounded-lg border border-blue-300"},null,8,be)]),e("div",{class:"flex-1"},[t[11]||(t[11]=e("p",{class:"text-sm text-blue-700"}," New icon ready to upload ",-1)),e("button",{onClick:O,type:"button",class:"text-xs text-blue-600 hover:text-blue-800 underline mt-1"}," Remove preview ")])])])):v("",!0),t[13]||(t[13]=e("p",{class:"text-xs text-blue-600"},[e("svg",{class:"w-4 h-4 inline mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),p(" Recommended: 200x200px, max 200KB for optimal performance ")],-1))])]),e("div",xe,[e("button",{type:"button",onClick:B,class:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors"},c(a.value?"Cancel":"Reset"),1),e("button",{type:"submit",disabled:b(d).loading,class:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},[b(d).loading?(i(),n("svg",we,t[15]||(t[15]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):v("",!0),p(" "+c(b(d).loading?"Saving...":a.value?"Update Category":"Create Category"),1)],8,he)])],32)]),e("div",ke,[t[23]||(t[23]=e("h2",{class:"text-xl font-semibold text-gray-900 mb-6"},"Existing Categories",-1)),e("div",Ce,[(i(!0),n(G,null,Q(f.value,(r,m)=>(i(),n("div",{key:r.id,class:"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors"},[e("div",_e,[e("div",je,[e("div",Me,[r.icon?(i(),n("img",{key:0,src:r.icon,alt:r.name,class:"w-10 h-10 object-cover rounded-lg border border-gray-300",onError:t[2]||(t[2]=y=>y.target.style.display="none")},null,40,Be)):(i(),n("div",Ee,t[16]||(t[16]=[e("svg",{class:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)])))]),e("span",ze,c(m+1),1),e("div",null,[e("h3",Ae,c(r.name),1),r.description?(i(),n("p",Fe,c(r.description),1)):v("",!0)])])]),e("div",Ie,[e("div",Se,[e("button",{onClick:y=>I(m),disabled:m===0,class:"p-1 text-gray-400 hover:text-gray-600 disabled:opacity-30 disabled:cursor-not-allowed transition-colors",title:"Move up"},t[17]||(t[17]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 15l7-7 7 7"})],-1)]),8,Ne),e("button",{onClick:y=>S(m),disabled:m===f.value.length-1,class:"p-1 text-gray-400 hover:text-gray-600 disabled:opacity-30 disabled:cursor-not-allowed transition-colors",title:"Move down"},t[18]||(t[18]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1)]),8,De)]),e("div",Le,[e("button",{onClick:y=>D(r),class:"p-2 text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-md transition-colors",title:"Edit category"},t[19]||(t[19]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)]),8,Te),e("button",{onClick:y=>L(r),class:"p-2 text-red-600 hover:text-red-800 hover:bg-red-50 rounded-md transition-colors",title:"Delete category"},t[20]||(t[20]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,Ve)])])]))),128))]),e("div",Oe,[e("button",{onClick:N,disabled:b(d).loading,class:"w-full px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},[b(d).loading?(i(),n("svg",Ue,t[21]||(t[21]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):v("",!0),t[22]||(t[22]=p(" Save Category Order "))],8,He)])])])]),_.value?(i(),n("div",Re,[e("div",$e,[e("div",Pe,[t[30]||(t[30]=e("div",{class:"flex items-center mb-4"},[e("div",{class:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100"},[e("svg",{class:"h-6 w-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.464 0L4.35 16.5c-.77.833.192 2.5 1.732 2.5z"})])])],-1)),e("div",Je,[t[27]||(t[27]=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"Delete Category",-1)),e("p",qe,[t[25]||(t[25]=p(' Are you sure you want to delete "')),e("span",Ke,c((l=h.value)==null?void 0:l.name),1),t[26]||(t[26]=p('"? This action cannot be undone. '))])]),e("div",Ge,[e("button",{onClick:t[3]||(t[3]=r=>_.value=!1),class:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors"}," Cancel "),e("button",{onClick:T,disabled:b(d).loading,class:"px-4 py-2 border border-transparent rounded-md text-sm font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},[b(d).loading?(i(),n("svg",We,t[28]||(t[28]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):v("",!0),t[29]||(t[29]=p(" Delete "))],8,Qe)])])])])):v("",!0)])}}};export{tt as default};

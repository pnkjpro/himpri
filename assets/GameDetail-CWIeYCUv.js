import{u as R}from"./mainStore-BhzJHaPt.js";import{u as T,a as $,s as g,B as p,c as r,b as t,h as A,i as s,t as i,l as B,F as j,d as C,o as a,m as F}from"./index-CU2fudyf.js";import{l as G,F as J}from"./index.es-Ce2FIoCW.js";import{b as q}from"./index-DHaoE_mB.js";import{u as I}from"./transactionStore-FcFXpXUE.js";const M={class:"flex flex-col min-h-screen bg-gray-100"},N={class:"m-4"},O={class:"bg-white rounded-xl p-4 shadow-sm"},P={class:"text-3xl font-bold my-1"},V={class:"w-full bg-gray-200 rounded-full h-2 mb-1"},D={class:"flex justify-between text-xs"},L={class:"text-red-500"},E={class:"text-gray-500"},Q={class:"mx-4 my-2"},U={key:1,disabled:"",class:"w-full bg-stone-400 text-white py-3 rounded-lg font-medium"},W={key:2,disabled:"",class:"w-full bg-stone-400 text-white py-3 rounded-lg font-medium"},H={key:3,disabled:"",class:"w-full bg-stone-400 text-white py-3 rounded-lg font-medium"},K=["disabled"],X={class:"overflow-y-auto flex-1"},Y={class:"w-full"},Z={class:"text-left py-3 px-6"},tt={class:"text-right py-3 px-6 text-gray-700"},lt={__name:"GameDetail",setup(et){G.add(q);const c=F(),b=T(),x=R(),v=$(),m=I(),{contest:y,prizeContents:_,variant:o}=g(x),{user:h}=g(v),w=async n=>{const e=await m.joinGame(o.value.id);e.success?(b.success(e.message),c.push("/quiz/instruction")):b.error(e.message)},k=n=>{const e=n.user_responses_count,l=n.slot_limit;if(!l)return 0;const u=e/l*100;return Math.max(0,Math.min(100,u))},f=p(()=>h.value.user_responses.find(n=>n.node_id==y.value.node_id)||null),d=p(()=>f.value?f.value.quiz_variant_id===o.value.id?f.value.status:"disabled":"pending"),S=()=>{c.back()},z=n=>{c.push(n)};return console.log(_.value),(n,e)=>(a(),r("div",M,[t("div",{onClick:e[0]||(e[0]=l=>S()),class:"bg-orange-500 text-white p-3 flex items-center"},[A(s(J),{icon:"arrow-left",class:"mr-2"})]),t("div",N,[t("div",O,[e[3]||(e[3]=t("div",{class:"text-gray-500 text-sm"},"Prize Pool",-1)),t("div",P,"₹ "+i(s(o).prize),1),t("div",V,[t("div",{class:"bg-red-500 h-2 rounded-full",style:B(`width: ${k(s(o))}%`)},null,4)]),t("div",D,[t("div",L,i(s(o).slot_limit-s(o).user_responses_count)+" spot left",1),t("div",E,"Total spot: "+i(s(o).slot_limit),1)])])]),t("div",Q,[d.value=="joined"?(a(),r("button",{key:0,onClick:e[1]||(e[1]=l=>z("/quiz/instruction")),class:"w-full bg-green-500 text-white py-3 rounded-lg font-medium"}," Start Quiz ")):d.value=="disabled"?(a(),r("button",U," Joined Other Variant! ")):d.value=="initiated"?(a(),r("button",W," Game Already Started! ")):d.value=="completed"?(a(),r("button",H," Under Review! ")):(a(),r("button",{key:4,onClick:e[2]||(e[2]=l=>w(s(o).id)),class:"w-full bg-green-500 text-white py-3 rounded-lg font-medium",disabled:s(m).loading},i(s(m).loading?"Joining...":`JOIN ₹ ${s(o).entry_fee}`),9,K))]),e[5]||(e[5]=t("div",{class:"flex border-b border-gray-200 mt-2"},[t("div",{class:"flex-1 text-center py-3 text-red-700 font-medium border-b-2 border-red-700"}," Winning ")],-1)),t("div",X,[t("table",Y,[e[4]||(e[4]=t("thead",null,[t("tr",{class:"border-b border-gray-200"},[t("th",{class:"text-left py-4 px-6 text-red-700 font-medium"},"Rank"),t("th",{class:"text-right py-4 px-6 text-red-700 font-medium"},"Amount")])],-1)),t("tbody",null,[(a(!0),r(j,null,C(s(_),(l,u)=>(a(),r("tr",{key:u,class:"border-b border-gray-100"},[t("td",Z,"Rank "+i(u),1),t("td",tt,"₹ "+i(l),1)]))),128))])])])]))}};export{lt as default};

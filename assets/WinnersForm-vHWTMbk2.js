import{m as T,ag as L,a1 as U,ah as B,ai as $,W as G,a9 as R,s as H,r as n,o as O,c as l,b as e,g as m,u as i,f as x,F as J,d as Y,h as v,t as d,y as K,z as _,A as k,j as r,D as p}from"./index-POsu4t_Q.js";import{u as Q}from"./mainStore-BMfi6C0O.js";import{_ as X}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Z={class:"min-h-screen bg-gray-50"},ee={class:"bg-white shadow-sm border-b border-gray-200 p-6"},te={class:"flex items-center justify-between"},ae=["disabled"],se={class:"p-6"},oe={key:0,class:"text-center py-12"},le={key:1,class:"text-center py-12"},re={class:"bg-gray-100 rounded-full p-6 w-24 h-24 mx-auto mb-4"},ne={key:2,class:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6"},ie={class:"relative"},de=["src","alt"],ue={class:"absolute top-2 right-2 bg-green-600 text-white text-xs px-2 py-1 rounded font-medium"},ce={class:"p-4"},me={class:"text-lg font-bold text-gray-900 mb-2"},ve={class:"text-sm text-gray-600 mb-2"},pe={class:"flex items-center justify-between text-xs text-gray-500 mb-4"},ge={class:"bg-blue-100 text-blue-800 px-2 py-1 rounded"},fe={class:"flex space-x-2"},be=["onClick"],xe=["onClick"],ye={key:3,class:"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg"},he={class:"flex items-center"},we={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},_e={class:"bg-white rounded-xl max-w-2xl w-full max-h-90vh overflow-y-auto"},ke={class:"sticky top-0 bg-white border-b border-gray-200 p-6"},We={class:"flex items-center justify-between"},Ce={class:"text-xl font-bold text-gray-900"},Fe={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Me={class:"mt-6"},Ae={class:"flex items-center space-x-4"},De={class:"relative"},Ie={key:0,class:"mt-4"},Ee={class:"relative inline-block"},Pe=["src"],je={key:0,class:"absolute -top-2 -right-2 bg-green-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs"},qe={class:"flex justify-end space-x-3 mt-8 pt-6 border-t border-gray-200"},Ne=["disabled"],Ve={key:0,class:"animate-spin -ml-1 mr-3 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},ze={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},Se={class:"bg-white rounded-xl max-w-md w-full"},Te={class:"p-6"},Le={class:"flex items-center justify-center w-12 h-12 mx-auto mb-4 bg-red-100 rounded-full"},Ue={class:"flex space-x-3"},Be=["disabled"],$e={__name:"WinnersForm",setup(Ge){T.add(L,U,B,$,G,R);const f=Q(),{loading:D}=H(f),g=n([]),y=n(!1),u=n(!1),h=n(!1),c=n(!1),w=n(null),W=n(null),b=n(null),s=n({name:"",amount:"",contest:"",date:"",avatar:"",avatarFile:null,avatarPreview:null}),A=["https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?auto=format&fit=crop&w=880&q=80","https://images.unsplash.com/photo-1527980965255-d3b416303d12?auto=format&fit=crop&w=880&q=80","https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?auto=format&fit=crop&w=880&q=80","https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?auto=format&fit=crop&w=880&q=80","https://images.unsplash.com/photo-1544005313-94ddf0286df2?auto=format&fit=crop&w=880&q=80","https://images.unsplash.com/photo-1547425260-76bcadfb4f2c?auto=format&fit=crop&w=880&q=80"],I=a=>A[a%A.length],E=a=>new Date(a).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}),P=a=>{const t=a.target.files[0];if(t){if(!t.type.startsWith("image/")){console.error("Please select an image file");return}if(t.size>5*1024*1024){console.error("Image size should be less than 5MB");return}s.value.avatarFile=t;const o=new FileReader;o.onload=M=>{s.value.avatarPreview=M.target.result},o.readAsDataURL(t)}},j=()=>{s.value.avatar="",s.value.avatarFile=null,s.value.avatarPreview=null,b.value&&(b.value.value="")},C=async()=>{try{const a=await f.fetchWinners();a.success?g.value=a.data||[]:console.error("Failed to fetch winners:",a.message)}catch(a){console.error("Error fetching winners:",a)}},q=()=>{s.value={name:"",amount:"",contest:"",date:"",avatar:"",avatarFile:null,avatarPreview:null},b.value&&(b.value.value=""),w.value=null},F=()=>{y.value=!1,u.value=!1,q()},N=a=>{w.value=a,s.value={name:a.name,amount:a.amount,contest:a.contest,date:new Date(a.date).toISOString().split("T")[0],avatar:a.avatar||"",avatarFile:null,avatarPreview:null},u.value=!0},V=async()=>{try{if(!u.value&&g.value.length>=3){console.error("Maximum 3 winners allowed");return}c.value=!0;const a=new FormData;a.append("name",s.value.name),a.append("amount",s.value.amount),a.append("contest",s.value.contest),a.append("date",s.value.date),s.value.avatarFile?a.append("avatar",s.value.avatarFile):s.value.avatar&&a.append("avatar_url",s.value.avatar);let t;u.value&&w.value?t=await f.updateWinner(w.value.uid,a):t=await f.addWinner(a),t.success?(F(),await C()):console.error("Failed to save winner:",t.message)}catch(a){console.error("Error saving winner:",a)}finally{c.value=!1}},z=a=>{W.value=a.uid,h.value=!0},S=async()=>{try{c.value=!0;const a=await f.deleteWinner(W.value);a.success?(h.value=!1,W.value=null,await C()):console.error("Failed to delete winner:",a.message)}catch(a){console.error("Error deleting winner:",a)}finally{c.value=!1}};return O(()=>{C()}),(a,t)=>(r(),l("div",Z,[e("div",ee,[e("div",te,[t[8]||(t[8]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900"},"Winners Management"),e("p",{class:"text-sm text-gray-600 mt-1"},"Manage recent winners displayed on landing page (Maximum 3 winners)")],-1)),e("button",{onClick:t[0]||(t[0]=o=>y.value=!0),disabled:g.value.length>=3,class:"bg-gradient-to-r from-blue-500 to-purple-600 text-white px-4 py-2 rounded-lg hover:from-blue-600 hover:to-purple-700 transition-colors flex items-center disabled:opacity-50 disabled:cursor-not-allowed"},[m(i(p),{icon:"plus",class:"mr-2"}),t[7]||(t[7]=x(" Add Winner "))],8,ae)])]),e("div",se,[i(D)?(r(),l("div",oe,t[9]||(t[9]=[e("div",{class:"inline-flex items-center px-4 py-2 font-semibold leading-6 text-sm shadow rounded-md text-blue-500 bg-white"},[e("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]),x(" Loading winners... ")],-1)]))):g.value.length===0?(r(),l("div",le,[e("div",re,[m(i(p),{icon:"trophy",class:"text-gray-400 text-4xl"})]),t[10]||(t[10]=e("h3",{class:"text-xl font-bold text-gray-700 mb-2"},"No Winners Added",-1)),t[11]||(t[11]=e("p",{class:"text-gray-500 mb-4"},"Add your first winner to get started (Maximum 3 winners allowed)",-1)),e("button",{onClick:t[1]||(t[1]=o=>y.value=!0),class:"bg-gradient-to-r from-blue-500 to-purple-600 text-white px-6 py-3 rounded-lg hover:from-blue-600 hover:to-purple-700 transition-colors"}," Add Winner ")])):(r(),l("div",ne,[(r(!0),l(J,null,Y(g.value,o=>(r(),l("div",{key:o.id,class:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden hover:shadow-lg transition-shadow"},[e("div",ie,[e("img",{src:o.avatar||I(o.id),alt:o.name,class:"w-full h-48 object-cover"},null,8,de),e("div",ue," ₹"+d(o.amount.toLocaleString()),1)]),e("div",ce,[e("h3",me,d(o.name),1),e("p",ve," Won ₹"+d(o.amount.toLocaleString())+" in "+d(o.contest),1),e("div",pe,[e("span",null,d(E(o.date)),1),e("span",ge,d(o.contest),1)]),e("div",fe,[e("button",{onClick:M=>N(o),class:"flex-1 bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-600 transition-colors text-sm font-medium"},[m(i(p),{icon:"edit",class:"mr-2"}),t[12]||(t[12]=x(" Edit "))],8,be),e("button",{onClick:M=>z(o),class:"flex-1 bg-red-500 text-white py-2 px-4 rounded-lg hover:bg-red-600 transition-colors text-sm font-medium"},[m(i(p),{icon:"trash",class:"mr-2"}),t[13]||(t[13]=x(" Delete "))],8,xe)])])]))),128))])),g.value.length>=3?(r(),l("div",ye,[e("div",he,[m(i(p),{icon:"exclamation-triangle",class:"text-yellow-600 mr-2"}),t[14]||(t[14]=e("p",{class:"text-yellow-800 text-sm font-medium"}," Maximum winner limit reached (3/3). You can edit or delete existing winners to add new ones. ",-1))])])):v("",!0)]),y.value||u.value?(r(),l("div",we,[e("div",_e,[e("div",ke,[e("div",We,[e("h2",Ce,d(u.value?"Edit Winner":"Add New Winner"),1),e("button",{onClick:F,class:"text-gray-400 hover:text-gray-600 transition-colors"},[m(i(p),{icon:"times",class:"text-xl"})])])]),e("form",{onSubmit:K(V,["prevent"]),class:"p-6"},[e("div",Fe,[e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Winner Name * ",-1)),_(e("input",{"onUpdate:modelValue":t[2]||(t[2]=o=>s.value.name=o),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter winner name"},null,512),[[k,s.value.name]])]),e("div",null,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Amount Won (₹) * ",-1)),_(e("input",{"onUpdate:modelValue":t[3]||(t[3]=o=>s.value.amount=o),type:"number",required:"",min:"1",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter amount won"},null,512),[[k,s.value.amount]])]),e("div",null,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Contest Name * ",-1)),_(e("input",{"onUpdate:modelValue":t[4]||(t[4]=o=>s.value.contest=o),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter contest name"},null,512),[[k,s.value.contest]])]),e("div",null,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Winner Date * ",-1)),_(e("input",{"onUpdate:modelValue":t[5]||(t[5]=o=>s.value.date=o),type:"date",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[k,s.value.date]])])]),e("div",Me,[t[20]||(t[20]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Avatar Image (Optional) ",-1)),e("div",Ae,[e("div",De,[e("input",{ref_key:"fileInput",ref:b,type:"file",accept:"image/*",onChange:P,class:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"},null,544),t[19]||(t[19]=e("button",{type:"button",class:"px-4 py-2 bg-gray-100 border border-gray-300 rounded-lg hover:bg-gray-200 transition-colors text-sm font-medium"}," Choose Image ",-1))]),s.value.avatarFile||s.value.avatar?(r(),l("button",{key:0,type:"button",onClick:j,class:"px-3 py-2 bg-red-100 text-red-600 border border-red-300 rounded-lg hover:bg-red-200 transition-colors text-sm font-medium"}," Clear ")):v("",!0)]),t[21]||(t[21]=e("p",{class:"text-xs text-gray-500 mt-1"}," Upload an image file (JPG, PNG, GIF). Leave empty to use default fallback image. ",-1))]),s.value.avatarPreview||s.value.avatar?(r(),l("div",Ie,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Preview",-1)),e("div",Ee,[e("img",{src:s.value.avatarPreview||s.value.avatar,alt:"Avatar preview",class:"w-24 h-24 rounded-lg object-cover border border-gray-200"},null,8,Pe),s.value.avatarFile?(r(),l("div",je," ✓ ")):v("",!0)])])):v("",!0),e("div",qe,[e("button",{type:"button",onClick:F,class:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"}," Cancel "),e("button",{type:"submit",disabled:c.value,class:"bg-gradient-to-r from-blue-500 to-purple-600 text-white px-6 py-2 rounded-lg hover:from-blue-600 hover:to-purple-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center"},[c.value?(r(),l("svg",Ve,t[23]||(t[23]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):v("",!0),x(" "+d(u.value?"Update Winner":"Add Winner"),1)],8,Ne)])],32)])])):v("",!0),h.value?(r(),l("div",ze,[e("div",Se,[e("div",Te,[e("div",Le,[m(i(p),{icon:"exclamation-triangle",class:"text-red-600 text-xl"})]),t[24]||(t[24]=e("h3",{class:"text-lg font-bold text-gray-900 text-center mb-2"},"Delete Winner",-1)),t[25]||(t[25]=e("p",{class:"text-gray-600 text-center mb-6"}," Are you sure you want to delete this winner? This action cannot be undone. ",-1)),e("div",Ue,[e("button",{onClick:t[6]||(t[6]=o=>h.value=!1),class:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"}," Cancel "),e("button",{onClick:S,disabled:c.value,class:"flex-1 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"}," Delete ",8,Be)])])])])):v("",!0)]))}},Je=X($e,[["__scopeId","data-v-c37b0cbe"]]);export{Je as default};

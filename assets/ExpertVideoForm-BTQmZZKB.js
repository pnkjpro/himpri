import{m as le,ag as ie,V as re,ah as ae,ai as ne,W as de,aj as ce,al as ue,p as pe,am as fe,an as me,ao as ve,ap as xe,aq as ge,Q as be,a9 as ye,$ as he,J as _e,v as we,r as v,ak as ke,o as N,a as Fe,c as i,b as e,g as n,u as d,f as g,F as Ve,d as Ce,t as u,y as Me,h as x,z as P,A as T,C as Ue,j as r,D as c}from"./index-BHNnW986.js";import{u as Ee}from"./mainStore-C-CtJKTC.js";import{_ as Pe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Ie={class:"min-h-screen bg-gray-50"},ze={class:"bg-white shadow-sm border-b border-gray-200 p-6"},De={class:"flex items-center justify-between"},$e={class:"p-6"},Te={key:0,class:"text-center py-12"},je={class:"bg-gray-100 rounded-full p-6 w-24 h-24 mx-auto mb-4"},Be={key:1,class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},Ae={class:"relative"},Le=["src","alt"],Se={class:"absolute top-2 left-2 bg-gradient-to-r from-yellow-500 to-orange-500 text-white text-xs px-2 py-1 rounded font-medium flex items-center"},qe=["onClick"],Ne={class:"bg-purple-600 rounded-full p-3 hover:bg-purple-700 transform hover:scale-110 transition-all"},Re={class:"absolute top-2 right-2 bg-black bg-opacity-75 text-white text-xs px-2 py-1 rounded"},Oe={class:"absolute bottom-2 left-2 flex space-x-1"},Ge={key:0,class:"bg-green-500 text-white text-xs px-2 py-1 rounded-full"},We={key:1,class:"bg-red-500 text-white text-xs px-2 py-1 rounded-full"},He={class:"p-4"},Je={class:"text-lg font-bold text-gray-900 mb-2 line-clamp-2"},Ke={class:"text-sm text-gray-600 mb-3 line-clamp-2"},Qe={class:"flex items-center justify-between text-xs text-gray-500 mb-4"},Ye={class:"flex items-center"},Xe={key:0,class:"flex items-center text-blue-600"},Ze={class:"flex space-x-2"},et=["onClick"],tt=["onClick"],ot=["onClick"],st={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},lt={class:"bg-white rounded-xl max-w-3xl w-full max-h-90vh overflow-y-auto"},it={class:"flex justify-between items-center p-6 border-b border-gray-200"},rt={class:"text-xl font-bold text-gray-900"},at={key:0,class:"form-group"},nt={class:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-purple-400 transition-colors"},dt={key:1,class:"text-green-600"},ct={class:"font-medium"},ut={class:"text-xs text-gray-500"},pt={class:"form-group"},ft={class:"flex space-x-4"},mt={class:"flex-1"},vt={class:"border-2 border-dashed border-gray-300 rounded-lg p-4 text-center hover:border-purple-400 transition-colors"},xt=["required"],gt={key:1,class:"relative"},bt=["src"],yt={class:"form-group"},ht={class:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-purple-400 transition-colors"},_t={key:1,class:"text-green-600"},wt={class:"font-medium"},kt={class:"text-xs text-gray-500"},Ft={class:"form-group"},Vt={class:"form-group"},Ct={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Mt={class:"form-group"},Ut={class:"form-group"},Et={class:"flex items-center"},Pt={class:"flex space-x-3 pt-4 border-t border-gray-200"},It=["disabled"],zt={key:0,class:"flex items-center justify-center"},Dt={key:1},$t={key:1,class:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4"},Tt={class:"bg-black rounded-xl max-w-4xl w-full max-h-90vh overflow-hidden relative"},jt={class:"absolute top-4 left-4 z-10 bg-black bg-opacity-50 text-white px-4 py-2 rounded-lg"},Bt={class:"text-lg font-bold"},At={class:"relative"},Lt=["src"],St=["src"],qt=["src"],Nt={key:1,class:"absolute inset-0 flex items-center justify-center bg-black"},Rt={key:2,class:"absolute inset-0 flex items-center justify-center bg-black text-white text-center p-8"},Ot={class:"text-sm text-gray-400"},Gt={key:3,class:"flex items-center justify-center bg-gray-900 text-white text-center p-8 h-64"},Wt={class:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black to-transparent text-white p-6"},Ht={class:"flex items-center justify-between"},Jt={class:"text-sm text-gray-300 mb-1"},Kt={class:"flex items-center space-x-4 text-sm text-gray-400"},Qt={class:"flex items-center"},Yt={__name:"ExpertVideoForm",setup(Xt){le.add(ie,re,ae,ne,de,ce,ue,pe,fe,me,ve,xe,ge,be,ye,he,_e);const F=Ee(),p=we(),b=v([]),_=v(!1),m=v(!1),V=v(!1),C=v(-1),M=v(!1),f=v(null),w=v(!1),k=v(!1),U=v(null),s=ke({title:"",description:"",duration:"",is_active:!0,is_premium:!0,is_featured:!1,videoFile:null,thumbnailFile:null,pdfFile:null}),h=v(null),R=o=>{const t=o.target.files[0];if(t){if(t.size>50*1024*1024){p.error("Video file size must be less than 50MB. Please compress your video before uploading.");return}if(!["video/mp4","video/mov","video/avi","video/quicktime"].includes(t.type)){p.error("Please upload a valid video file (MP4, MOV, or AVI)");return}s.videoFile=t}},O=o=>{const t=o.target.files[0];if(t){if(t.size>5*1024*1024){p.error("Thumbnail file size must be less than 5MB");return}s.thumbnailFile=t;const a=new FileReader;a.onload=y=>{h.value=y.target.result},a.readAsDataURL(t)}},G=o=>{const t=o.target.files[0];if(t){if(t.size>10*1024*1024){p.error("PDF file size must be less than 10MB");return}if(t.type!=="application/pdf"){p.error("Please upload a valid PDF file");return}s.pdfFile=t}},W=()=>{s.videoFile=null;const o=document.querySelector('input[type="file"][accept="video/*"]');o&&(o.value="")},H=()=>{s.thumbnailFile=null,h.value=null;const o=document.querySelector('input[type="file"][accept="image/*"]');o&&(o.value="")},J=()=>{s.pdfFile=null;const o=document.querySelector('input[type="file"][accept=".pdf"]');o&&(o.value="")},j=o=>{if(o===0)return"0 Bytes";const t=1024,a=["Bytes","KB","MB","GB"],y=Math.floor(Math.log(o)/Math.log(t));return parseFloat((o/Math.pow(t,y)).toFixed(2))+" "+a[y]},I=o=>o?o.startsWith("http")?o:`http://dreamwin.local:8000/storage/${o}`:"/images/fallbackImage.png",z=o=>o?o.startsWith("http")?o:`http://dreamwin.local:8000/storage/${o}`:null,K=o=>{if(o.pdf_attachment){const t=I(o.pdf_attachment),a=document.createElement("a");a.href=t,a.download=`${o.title}_attachment.pdf`,a.target="_blank",document.body.appendChild(a),a.click(),document.body.removeChild(a)}},Q=o=>{f.value=o,w.value=!0,k.value=!1,V.value=!0},B=()=>{V.value=!1,f.value=null,w.value=!1,k.value=!1,U.value&&(U.value.pause(),U.value.currentTime=0)},Y=()=>{w.value=!1,k.value=!1},X=o=>{console.error("Video loading error:",o),w.value=!1,k.value=!0,p.error("Failed to load video. Please check the video URL.")},Z=o=>o?new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A",ee=()=>{s.title="",s.description="",s.duration="",s.is_active=!0,s.videoFile=null,s.thumbnailFile=null,s.pdfFile=null,h.value=null},E=()=>{_.value=!1,m.value=!1,C.value=-1,ee()},te=(o,t)=>{C.value=t,s.title=o.title,s.description=o.description,s.duration=o.duration,s.is_active=o.is_active,o.thumbnail&&(h.value=I(o.thumbnail)),m.value=!0},oe=async o=>{if(confirm("Are you sure you want to delete this video? This action cannot be undone.")){const t=b.value[o];try{const a=await F.deleteExpertVideo(t.id);a.success?(b.value.splice(o,1),p.success("Video deleted successfully")):p.error(a.message||"Failed to delete video")}catch(a){console.error("Error deleting video:",a),p.error("Failed to delete video")}}},se=async()=>{M.value=!0;try{const o=new FormData;o.append("title",s.title),o.append("description",s.description),o.append("duration",s.duration),o.append("is_active",s.is_active?"1":"0"),o.append("is_premium","1"),o.append("is_featured","0"),s.videoFile&&o.append("video",s.videoFile),s.thumbnailFile&&o.append("thumbnail",s.thumbnailFile),s.pdfFile&&o.append("pdf_attachment",s.pdfFile);let t;m.value?(o.append("video_id",b.value[C.value].id),t=await F.updateExpertVideo(b.value[C.value].id,o)):t=await F.createExpertVideo(o),t.success?(p.success(m.value?"Video updated successfully":"Video uploaded successfully"),E(),await A()):t.errors?Object.values(t.errors).flat().forEach(a=>{p.error(a)}):p.error(t.message||"Operation failed")}catch(o){console.error("Error submitting form:",o),p.error("An error occurred. Please try again.")}finally{M.value=!1}},A=async()=>{try{const o=await F.fetchExpertVideos();o.success&&(b.value=o.data)}catch(o){console.error("Error fetching videos:",o)}};N(async()=>{await A()});const L=o=>{o.key==="Escape"&&(V.value?B():(_.value||m.value)&&E())};return N(()=>{document.addEventListener("keydown",L)}),Fe(()=>{document.removeEventListener("keydown",L)}),(o,t)=>{var a,y,S,q;return r(),i("div",Ie,[e("div",ze,[e("div",De,[t[10]||(t[10]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900"},"Expert Video Management"),e("p",{class:"text-sm text-gray-600 mt-1"},"Upload and manage premium expert videos")],-1)),e("button",{onClick:t[0]||(t[0]=l=>_.value=!0),class:"bg-gradient-to-r from-purple-500 to-indigo-600 text-white px-4 py-2 rounded-lg hover:from-purple-600 hover:to-indigo-700 transition-colors flex items-center"},[n(d(c),{icon:"plus",class:"mr-2"}),t[9]||(t[9]=g(" Upload Video "))])])]),e("div",$e,[b.value.length===0?(r(),i("div",Te,[e("div",je,[n(d(c),{icon:"video",class:"text-gray-400 text-4xl"})]),t[11]||(t[11]=e("h3",{class:"text-xl font-bold text-gray-700 mb-2"},"No Expert Videos",-1)),t[12]||(t[12]=e("p",{class:"text-gray-500 mb-4"},"Upload your first expert video to get started",-1)),e("button",{onClick:t[1]||(t[1]=l=>_.value=!0),class:"bg-gradient-to-r from-purple-500 to-indigo-600 text-white px-6 py-3 rounded-lg hover:from-purple-600 hover:to-indigo-700 transition-colors"}," Upload Video ")])):(r(),i("div",Be,[(r(!0),i(Ve,null,Ce(b.value,(l,D)=>(r(),i("div",{key:l.id||D,class:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden hover:shadow-lg transition-shadow"},[e("div",Ae,[e("img",{src:I(l.thumbnail),alt:l.title,class:"w-full h-48 object-cover"},null,8,Le),e("div",Se,[n(d(c),{icon:"crown",class:"mr-1"}),t[13]||(t[13]=g(" PREMIUM "))]),e("div",{onClick:$=>Q(l),class:"absolute inset-0 bg-black bg-opacity-30 flex items-center justify-center cursor-pointer hover:bg-opacity-40 transition-all"},[e("div",Ne,[n(d(c),{icon:"play",class:"text-white text-xl"})])],8,qe),e("div",Re,u(l.duration),1),e("div",Oe,[l.is_active?(r(),i("span",Ge," Active ")):(r(),i("span",We," Inactive "))])]),e("div",He,[e("h3",Je,u(l.title),1),e("p",Ke,u(l.description),1),e("div",Qe,[e("span",Ye,[n(d(c),{icon:"calendar",class:"mr-1"}),g(" "+u(Z(l.created_at)),1)]),l.pdf_attachment?(r(),i("span",Xe,[n(d(c),{icon:"file-pdf",class:"mr-1"}),t[14]||(t[14]=g(" PDF "))])):x("",!0)]),e("div",Ze,[e("button",{onClick:$=>te(l,D),class:"flex-1 bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-600 transition-colors text-sm font-medium"},[n(d(c),{icon:"edit",class:"mr-2"}),t[15]||(t[15]=g(" Edit "))],8,et),l.pdf_attachment?(r(),i("button",{key:0,onClick:$=>K(l),class:"bg-green-500 text-white py-2 px-4 rounded-lg hover:bg-green-600 transition-colors text-sm font-medium"},[n(d(c),{icon:"file-pdf"})],8,tt)):x("",!0),e("button",{onClick:$=>oe(D),class:"bg-red-500 text-white py-2 px-4 rounded-lg hover:bg-red-600 transition-colors text-sm font-medium"},[n(d(c),{icon:"trash"})],8,ot)])])]))),128))]))]),_.value||m.value?(r(),i("div",st,[e("div",lt,[e("div",it,[e("h3",rt,u(m.value?"Edit Expert Video":"Upload Expert Video"),1),e("button",{onClick:E,class:"text-gray-400 hover:text-gray-600"},[n(d(c),{icon:"times",class:"text-xl"})])]),e("form",{onSubmit:Me(se,["prevent"]),class:"p-6 space-y-6"},[m.value?x("",!0):(r(),i("div",at,[t[18]||(t[18]=e("label",{class:"block mb-2 font-medium text-gray-700"},"Video File *",-1)),e("div",nt,[e("input",{type:"file",ref:"videoFileInput",onChange:R,accept:"video/*",class:"hidden",required:""},null,544),s.videoFile?(r(),i("div",dt,[n(d(c),{icon:"check-circle",class:"text-2xl mb-2"}),e("p",ct,u(s.videoFile.name),1),e("p",ut,u(j(s.videoFile.size)),1),e("button",{onClick:W,type:"button",class:"mt-2 text-red-500 hover:text-red-700 text-sm"}," Remove File ")])):(r(),i("div",{key:0,onClick:t[2]||(t[2]=l=>o.$refs.videoFileInput.click()),class:"cursor-pointer"},[n(d(c),{icon:"cloud-upload-alt",class:"text-4xl text-gray-400 mb-2"}),t[16]||(t[16]=e("p",{class:"text-gray-600 mb-1"},"Click to upload video file",-1)),t[17]||(t[17]=e("p",{class:"text-xs text-gray-500"},"Supported formats: MP4, MOV, AVI (Max: 50MB)",-1))]))])])),e("div",pt,[t[21]||(t[21]=e("label",{class:"block mb-2 font-medium text-gray-700"},"Thumbnail Image *",-1)),e("div",ft,[e("div",mt,[e("div",vt,[e("input",{type:"file",ref:"thumbnailFileInput",onChange:O,accept:"image/*",class:"hidden",required:!m.value},null,40,xt),h.value?(r(),i("div",gt,[e("img",{src:h.value,alt:"Thumbnail Preview",class:"w-full h-24 object-cover rounded"},null,8,bt),e("button",{onClick:H,type:"button",class:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 text-xs hover:bg-red-600"},[n(d(c),{icon:"times"})])])):(r(),i("div",{key:0,onClick:t[3]||(t[3]=l=>o.$refs.thumbnailFileInput.click()),class:"cursor-pointer"},[n(d(c),{icon:"image",class:"text-2xl text-gray-400 mb-2"}),t[19]||(t[19]=e("p",{class:"text-gray-600 text-sm"},"Upload thumbnail",-1)),t[20]||(t[20]=e("p",{class:"text-xs text-gray-500"},"JPG, PNG (Max: 5MB)",-1))]))])])])]),e("div",yt,[t[24]||(t[24]=e("label",{class:"block mb-2 font-medium text-gray-700"},"PDF Attachment (Optional)",-1)),e("div",ht,[e("input",{type:"file",ref:"pdfFileInput",onChange:G,accept:".pdf",class:"hidden"},null,544),s.pdfFile?(r(),i("div",_t,[n(d(c),{icon:"check-circle",class:"text-2xl mb-2"}),e("p",wt,u(s.pdfFile.name),1),e("p",kt,u(j(s.pdfFile.size)),1),e("button",{onClick:J,type:"button",class:"mt-2 text-red-500 hover:text-red-700 text-sm"}," Remove File ")])):(r(),i("div",{key:0,onClick:t[4]||(t[4]=l=>o.$refs.pdfFileInput.click()),class:"cursor-pointer"},[n(d(c),{icon:"file-pdf",class:"text-4xl text-gray-400 mb-2"}),t[22]||(t[22]=e("p",{class:"text-gray-600 mb-1"},"Click to upload PDF file",-1)),t[23]||(t[23]=e("p",{class:"text-xs text-gray-500"},"PDF format only (Max: 10MB)",-1))]))])]),e("div",Ft,[t[25]||(t[25]=e("label",{for:"title",class:"block mb-2 font-medium text-gray-700"},"Video Title *",-1)),P(e("input",{id:"title","onUpdate:modelValue":t[5]||(t[5]=l=>s.title=l),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500",placeholder:"Enter video title",required:""},null,512),[[T,s.title]])]),e("div",Vt,[t[26]||(t[26]=e("label",{for:"description",class:"block mb-2 font-medium text-gray-700"},"Description",-1)),P(e("textarea",{id:"description","onUpdate:modelValue":t[6]||(t[6]=l=>s.description=l),rows:"4",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500",placeholder:"Enter video description"},null,512),[[T,s.description]])]),e("div",Ct,[e("div",Mt,[t[27]||(t[27]=e("label",{for:"duration",class:"block mb-2 font-medium text-gray-700"},"Duration *",-1)),P(e("input",{id:"duration","onUpdate:modelValue":t[7]||(t[7]=l=>s.duration=l),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500",placeholder:"e.g., 15:30",required:""},null,512),[[T,s.duration]])])]),e("div",Ut,[e("label",Et,[P(e("input",{"onUpdate:modelValue":t[8]||(t[8]=l=>s.is_active=l),type:"checkbox",class:"w-4 h-4 text-purple-600 bg-gray-100 border-gray-300 rounded focus:ring-purple-500 focus:ring-2"},null,512),[[Ue,s.is_active]]),t[28]||(t[28]=e("span",{class:"ml-2 text-sm font-medium text-gray-700"},"Make video active immediately",-1))])]),e("div",Pt,[e("button",{type:"button",onClick:E,class:"flex-1 px-4 py-3 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors font-medium"}," Cancel "),e("button",{type:"submit",disabled:M.value,class:"flex-1 px-4 py-3 bg-gradient-to-r from-purple-500 to-indigo-600 text-white rounded-lg hover:from-purple-600 hover:to-indigo-700 transition-colors disabled:opacity-50 font-medium"},[M.value?(r(),i("span",zt,[t[29]||(t[29]=e("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),g(" "+u(m.value?"Updating...":"Uploading..."),1)])):(r(),i("span",Dt,u(m.value?"Update Video":"Upload Video"),1))],8,It)])],32)])])):x("",!0),V.value?(r(),i("div",$t,[e("div",Tt,[e("button",{onClick:B,class:"absolute top-4 right-4 z-10 bg-black bg-opacity-50 text-white rounded-full p-2 hover:bg-opacity-75 transition-opacity"},[n(d(c),{icon:"times",class:"text-xl"})]),e("div",jt,[e("h3",Bt,u((a=f.value)==null?void 0:a.title),1)]),e("div",At,[f.value&&f.value.videoUrl?(r(),i("video",{key:0,ref_key:"videoPlayer",ref:U,class:"w-full h-auto max-h-[80vh]",controls:"",autoplay:"",preload:"metadata",onLoadedmetadata:Y,onError:X},[e("source",{src:z(f.value.videoUrl),type:"video/mp4"},null,8,Lt),e("source",{src:z(f.value.videoUrl),type:"video/webm"},null,8,St),e("source",{src:z(f.value.videoUrl),type:"video/ogg"},null,8,qt),t[30]||(t[30]=g(" Your browser does not support the video tag. "))],544)):x("",!0),w.value?(r(),i("div",Nt,t[31]||(t[31]=[e("div",{class:"text-center text-white"},[e("svg",{class:"animate-spin h-12 w-12 text-white mx-auto mb-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]),e("p",null,"Loading video...")],-1)]))):x("",!0),k.value?(r(),i("div",Rt,[e("div",null,[n(d(c),{icon:"exclamation-triangle",class:"text-4xl text-red-500 mb-4"}),t[32]||(t[32]=e("h3",{class:"text-xl font-bold mb-2"},"Video Not Available",-1)),t[33]||(t[33]=e("p",{class:"text-gray-300 mb-4"},"Sorry, this video cannot be played at the moment.",-1)),e("p",Ot,"Video URL: "+u((y=f.value)==null?void 0:y.videoUrl),1)])])):x("",!0),f.value&&!f.value.videoUrl?(r(),i("div",Gt,[e("div",null,[n(d(c),{icon:"video",class:"text-4xl text-gray-500 mb-4"}),t[34]||(t[34]=e("h3",{class:"text-xl font-bold mb-2"},"No Video URL",-1)),t[35]||(t[35]=e("p",{class:"text-gray-300"},"This video doesn't have a playable URL configured.",-1))])])):x("",!0)]),e("div",Wt,[e("div",Ht,[e("div",null,[e("p",Jt,u((S=f.value)==null?void 0:S.description),1),e("div",Kt,[e("span",Qt,[n(d(c),{icon:"clock",class:"mr-1"}),g(" "+u((q=f.value)==null?void 0:q.duration),1)])])])])])])])):x("",!0)])}}},oo=Pe(Yt,[["__scopeId","data-v-045d929f"]]);export{oo as default};

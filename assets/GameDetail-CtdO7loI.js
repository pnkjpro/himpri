import{u as R}from"./mainStore-ItKn7B0_.js";import{m as T,I as $,v as j,x as A,s as b,M as p,c as a,b as t,g as B,u as s,t as i,k as C,F as G,d as I,j as l,D as J,l as M}from"./index-LZ7Ng8Fw.js";import{u as q}from"./transactionStore-BiWy66FO.js";const D={class:"flex flex-col min-h-screen bg-gray-100"},F={class:"m-4"},N={class:"bg-white rounded-xl p-4 shadow-sm"},O={class:"text-3xl font-bold my-1"},P={class:"w-full bg-gray-200 rounded-full h-2 mb-1"},V={class:"flex justify-between text-xs"},L={class:"text-red-500"},E={class:"text-gray-500"},Q={class:"mx-4 my-2"},U={key:1,disabled:"",class:"w-full bg-stone-400 text-white py-3 rounded-lg font-medium"},W={key:2,disabled:"",class:"w-full bg-stone-400 text-white py-3 rounded-lg font-medium"},H={key:3,disabled:"",class:"w-full bg-stone-400 text-white py-3 rounded-lg font-medium"},K=["disabled"],X={class:"overflow-y-auto flex-1"},Y={class:"w-full"},Z={class:"text-left py-3 px-6"},tt={class:"text-right py-3 px-6 text-gray-700"},at={__name:"GameDetail",setup(et){T.add($);const c=M(),g=j(),x=R(),v=A(),m=q(),{contest:y,prizeContents:_,variant:o}=b(x),{user:h}=b(v),w=async n=>{const e=await m.joinGame(o.value.id);e.success?(g.success(e.message),c.push("/quiz/instruction")):g.error(e.message)},k=n=>{const e=n.user_responses_count,r=n.slot_limit;if(!r)return 0;const u=e/r*100;return Math.max(0,Math.min(100,u))},f=p(()=>h.value.user_responses.find(n=>n.node_id==y.value.node_id)||null),d=p(()=>f.value?f.value.quiz_variant_id===o.value.id?f.value.status:"disabled":"pending"),S=()=>{c.back()},z=n=>{c.push(n)};return console.log(_.value),(n,e)=>(l(),a("div",D,[t("div",{onClick:e[0]||(e[0]=r=>S()),class:"bg-orange-500 text-white p-3 flex items-center"},[B(s(J),{icon:"arrow-left",class:"mr-2"})]),t("div",F,[t("div",N,[e[3]||(e[3]=t("div",{class:"text-gray-500 text-sm"},"Prize Pool",-1)),t("div",O,"₹ "+i(s(o).prize),1),t("div",P,[t("div",{class:"bg-red-500 h-2 rounded-full",style:C(`width: ${k(s(o))}%`)},null,4)]),t("div",V,[t("div",L,i(s(o).slot_limit-s(o).user_responses_count)+" spot left",1),t("div",E,"Total spot: "+i(s(o).slot_limit),1)])])]),t("div",Q,[d.value=="joined"?(l(),a("button",{key:0,onClick:e[1]||(e[1]=r=>z("/quiz/instruction")),class:"w-full bg-green-500 text-white py-3 rounded-lg font-medium"}," Start Quiz ")):d.value=="disabled"?(l(),a("button",U," Joined Other Variant! ")):d.value=="initiated"?(l(),a("button",W," Game Already Started! ")):d.value=="completed"?(l(),a("button",H," Under Review! ")):(l(),a("button",{key:4,onClick:e[2]||(e[2]=r=>w(s(o).id)),class:"w-full bg-green-500 text-white py-3 rounded-lg font-medium",disabled:s(m).loading},i(s(m).loading?"Joining...":`JOIN ₹ ${s(o).entry_fee}`),9,K))]),e[5]||(e[5]=t("div",{class:"flex border-b border-gray-200 mt-2"},[t("div",{class:"flex-1 text-center py-3 text-red-700 font-medium border-b-2 border-red-700"}," Winning ")],-1)),t("div",X,[t("table",Y,[e[4]||(e[4]=t("thead",null,[t("tr",{class:"border-b border-gray-200"},[t("th",{class:"text-left py-4 px-6 text-red-700 font-medium"},"Rank"),t("th",{class:"text-right py-4 px-6 text-red-700 font-medium"},"Amount")])],-1)),t("tbody",null,[(l(!0),a(G,null,I(s(_),(r,u)=>(l(),a("tr",{key:u,class:"border-b border-gray-100"},[t("td",Z,"Rank "+i(u),1),t("td",tt,"₹ "+i(r),1)]))),128))])])])]))}};export{at as default};

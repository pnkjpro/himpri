import{_ as O,r as g,s as y,u as T,E as I,y as M,c as m,b as s,w as U,f as b,v as C,t as d,i as _,F as h,d as j,o as p}from"./index-Cyd-YM9-.js";import{u as B}from"./adminStore-DBVpwMZ2.js";import"./index.esm-CU5o1HwE.js";import{u as J}from"./mainStore-ClbgWKYi.js";const R={class:"admin-form-container"},V={class:"form-group"},$={class:"form-group"},q={class:"form-group"},z={class:"file-field"},K={class:"file-name"},L={class:"form-actions"},P=["disabled"],G={class:"sortable-list"},H={class:"sort-controls"},Q=["onClick","disabled"],W=["onClick","disabled"],X={__name:"CreateCategory",setup(Y){const f={name:"",description:"",icon:"",display_order:1},a=g({...f}),v=()=>{Object.assign(a.value,JSON.parse(JSON.stringify(f)))},l=B(),u=J(),{categories:S}=y(u);y(l);const i=T(),n=g([]);I(S,t=>{n.value=Array.isArray(t)?[...t]:[]},{immediate:!0});const k=t=>{if(t>0){const e=n.value;[e[t-1],e[t]]=[e[t],e[t-1]]}},w=t=>{if(t<n.value.length-1){const e=n.value;[e[t],e[t+1]]=[e[t+1],e[t]]}},A=async()=>{const t=n.value.map((o,r)=>({id:o.id,display_order:r+1}));(await l.updateCategorySorting(t)).success?(i.success("Category order updated!"),u.fetchCategories()):i.error("Failed to update sorting.")};M(()=>{u.fetchCategories()});const F=t=>{const e=t.target.files[0];e&&(a.value.iconFile=e,a.value.icon=e.name)},N=async()=>{const t=new FormData;t.append("name",a.value.name),t.append("description",a.value.description),a.value.iconFile&&t.append("icon",a.value.iconFile);const e=await l.createCategory(t);if(!e.success){const o=e.message;typeof o=="object"&&o!==null&&!Array.isArray(o)?Object.values(o).forEach((r,c)=>{r.forEach((D,E)=>{setTimeout(()=>i.error(D),(c+E)*300)})}):Array.isArray(o)?o.forEach((r,c)=>{setTimeout(()=>i.error(r),c*300)}):i.error(o);return}i.success(e.message),v()};return(t,e)=>(p(),m(h,null,[s("div",R,[e[6]||(e[6]=s("h2",{class:"form-title"},"Add New Category",-1)),s("form",{onSubmit:U(N,["prevent"]),class:"category-form"},[s("div",V,[e[2]||(e[2]=s("label",{for:"name"},"Category Name",-1)),b(s("input",{id:"name","onUpdate:modelValue":e[0]||(e[0]=o=>a.value.name=o),type:"text",class:"form-control",required:""},null,512),[[C,a.value.name]])]),s("div",$,[e[3]||(e[3]=s("label",{for:"description"},"Description",-1)),b(s("textarea",{id:"description","onUpdate:modelValue":e[1]||(e[1]=o=>a.value.description=o),class:"form-control",rows:"3"},null,512),[[C,a.value.description]])]),s("div",q,[e[5]||(e[5]=s("label",{for:"icon"},"Icon",-1)),s("div",z,[s("input",{id:"icon",type:"file",onChange:F,class:"file-input",accept:"image/*"},null,32),s("span",K,d(a.value.icon||"No file chosen"),1),e[4]||(e[4]=s("span",{class:"text-xs text-blue-500"},"Note: Icon size 200x200 and should not exceed 200 Kb for better frontload.",-1))])]),s("div",L,[s("button",{type:"button",onClick:v,class:"btn-cancel"},"Cancel"),s("button",{type:"submit",class:"btn-save",disabled:_(l).loading},d(_(l).loading?"Saving...":"Save Category"),9,P)])],32)]),e[7]||(e[7]=s("h2",{class:"form-title mt-10"},"Reorder Categories",-1)),s("div",G,[(p(!0),m(h,null,j(n.value,(o,r)=>(p(),m("div",{key:o.id,class:"sortable-item"},[s("span",null,d(r+1)+". "+d(o.name),1),s("div",H,[s("button",{onClick:c=>k(r),disabled:r===0},"⬆️",8,Q),s("button",{onClick:c=>w(r),disabled:r===n.value.length-1},"⬇️",8,W)])]))),128))]),s("div",{class:"form-actions"},[s("button",{class:"btn-save",onClick:A},"Save Order")])],64))}},te=O(X,[["__scopeId","data-v-237d6357"]]);export{te as default};

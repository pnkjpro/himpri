import{m as D,I,v as R,r as m,x as K,s as w,o as k,a as $,c as a,b as e,g as q,u as n,h as y,F as j,d as E,f as _,j as i,D as C,t as d,n as F,l as U}from"./index-LZ7Ng8Fw.js";import{u as H}from"./quizStore-BWMWlWA-.js";import{u as Q}from"./mainStore-ItKn7B0_.js";import{f as h,a as O}from"./fromUnixTime-Bu3IzSon.js";import"./normalizeDates-MJlMPps6.js";import"./en-US-ClfMaaVW.js";import"./differenceInSeconds-C3I0pIaR.js";const P={class:"flex flex-col min-h-screen bg-gray-100"},G={class:"w-full overflow-x-auto rounded-lg shadow-sm"},J={class:"min-w-full divide-y divide-gray-200"},W={class:"bg-white divide-y divide-gray-200"},X={key:0,class:"hover:bg-gray-50"},Y={class:"hover:bg-gray-50"},Z={class:"px-4 py-4 whitespace-nowrap text-sm text-gray-900"},tt={class:"px-4 py-4 whitespace-nowrap text-sm font-medium"},et=["onClick","disabled"],st={class:"px-4 py-4 whitespace-nowrap"},ot={class:"mb-2"},at=["onClick"],it=["onClick"],rt={key:2,class:"text-blue-500 font-medium"},nt={class:"px-4 py-4 whitespace-nowrap text-sm font-medium"},lt={key:0,class:"py-8 text-center text-gray-500"},ct={key:1,class:"my-4 text-center"},dt=["disabled"],ut={key:0,class:"flex items-center justify-center"},mt={key:1,class:"flex items-center justify-center"},zt={__name:"MyContests",setup(xt){D.add(I);const u=U(),g=R(),x=m(1),v=m(!0),L=m(!1),r=H(),S=K(),f=Q();w(S);const{responses:z,loading:ft}=w(r);w(f),k(()=>{b()});const b=async()=>{const o=await r.getUserResponses(x.value);o.success?o.pagination?x.value=x.value+1:v.value=!1:g.error("failed to fetch my constests")},N=m(new Date);k(()=>{const o=setInterval(()=>{N.value=new Date},6e4);$(()=>{clearInterval(o)})});function l(o,s,t){const p=new Date,c=h(Number(o));h(Number(s));const B=h(Number(t));return p>=B?(L.value=!0,{isLive:!1,text:"Show Result"}):p>=c?{isLive:!0,text:"LIVE"}:{isLive:!1,text:O(c)+" left"}}const A=async(o,s)=>{await f.fetchCurrentContest(o),f.getPrizeContents(s),u.push("/quiz/variant/details")},T=o=>{r.getLeaderboard(o),u.push("/quiz/leaderboard")},M=async o=>{(await r.showAnswerKey(o)).success?u.push("/dashboard/answer-key"):g.error("Error loading answer key")},V=()=>{u.back()};return(o,s)=>(i(),a("div",P,[e("div",{onClick:s[0]||(s[0]=t=>V()),class:"bg-orange-500 text-white p-3 flex items-center"},[q(n(C),{icon:"arrow-left",class:"mr-2"}),s[1]||(s[1]=e("span",{class:"font-medium"},"My Contests",-1))]),e("div",G,[e("table",J,[s[4]||(s[4]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Node ID"),e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Quiz Name"),e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Answer Key"),e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Score")])],-1)),e("tbody",W,[n(r).loading?(i(),a("tr",X,s[2]||(s[2]=[e("td",{colspan:"4",class:"px-4 py-8 text-center"},[e("div",{class:"flex justify-center items-center space-x-2"},[e("svg",{class:"animate-spin h-5 w-5 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]),e("span",{class:"text-sm text-gray-600"},"Loading quiz responses...")])],-1)]))):y("",!0),(i(!0),a(j,null,E(n(z),(t,p)=>(i(),a("tr",Y,[e("td",Z,d(t.node_id),1),e("td",tt,d(t.quiz.title),1),e("td",{onClick:c=>M(t.node_id),class:F(["px-4 py-4 whitespace-nowrap",l(t.quiz.start_time,t.quiz.end_time,t.quiz.quiz_over_at).text==="Show Result"&&t.score!==0?"text-blue-500 font-medium cursor-pointer hover:text-blue-600":"text-gray-400 font-medium cursor-not-allowed opacity-50"]),disabled:l(t.quiz.start_time,t.quiz.end_time,t.quiz.quiz_over_at).text!=="Show Result"||t.score===0}," Answer Key ",10,et),e("td",st,[e("div",ot,[l(t.quiz.start_time,t.quiz.end_time,t.quiz.quiz_over_at).isLive?(i(),a("p",{key:0,onClick:c=>A(t.node_id,t.quiz_variant_id),class:"text-red-500 font-bold flex items-center"},s[3]||(s[3]=[e("span",{class:"inline-block h-2 w-2 rounded-full bg-red-500 mr-2"},null,-1),_(" LIVE ")]),8,at)):l(t.quiz.start_time,t.quiz.end_time,t.quiz.quiz_over_at).text==="Show Result"?(i(),a("p",{key:1,onClick:c=>T(t.node_id),class:"text-blue-500 font-medium"},d(l(t.quiz.start_time,t.quiz.end_time,t.quiz.quiz_over_at).text),9,it)):(i(),a("p",rt,d(l(t.quiz.start_time,t.quiz.end_time,t.quiz.quiz_over_at).text),1))])]),e("td",nt,d(t.score),1)]))),256))])]),n(z).length===0?(i(),a("div",lt," No data available. ")):y("",!0),v.value?(i(),a("div",ct,[e("button",{onClick:b,class:"px-8 py-3 bg-gradient-to-r from-red-600 to-orange-600 text-white rounded-full shadow-lg hover:from-red-700 hover:to-orange-700 focus:outline-none focus:ring-2 focus:ring-red-400 transition-all transform hover:scale-105",disabled:n(r).loading},[n(r).loading?(i(),a("span",ut,s[5]||(s[5]=[e("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),_(" Loading... ")]))):(i(),a("span",mt,[s[6]||(s[6]=_(" Load More ")),q(n(C),{icon:"chevron-down",class:"ml-2"})]))],8,dt)])):y("",!0)])]))}};export{zt as default};

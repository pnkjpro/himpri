import{u as R,a as S,s as z,r as m,y as H,z as u,A as N,c as l,b as t,F as I,d as M,e as $,w as j,t as k,p as F,n as V,i as _,k as C,o as n,l as K,f as U,v as G,m as q,q as J}from"./index-BYEICyHV.js";const Q={class:"min-h-screen bg-gradient-to-b from-gray-100 to-gray-800 flex flex-col items-center relative overflow-hidden"},W={class:"relative inset-0 opacity-10"},X={class:"text-4xl text-gray-500"},Y={class:"bg-white rounded-3xl p-8 w-11/12 max-w-md shadow-lg"},Z={class:"mb-6"},ee={class:"flex justify-center gap-2"},te=["onUpdate:modelValue","onInput","onKeydown"],se={key:0,class:"text-red-500 text-sm mt-4 text-center"},oe=["disabled"],ae={key:0,class:"flex items-center justify-center"},le={key:1},ne={class:"mt-6 text-center"},re=["disabled"],ie={key:0,class:"flex items-center justify-center"},ce={key:1},ue={key:2},d=6,pe={__name:"VerifyOtp",setup(de){const v=q(),f=R();J();const p=S(),{verifyEmail:g,verificationLabel:h}=z(p),o=m(Array(d).fill("")),r=m([]),x=m(!1),c=m(0),w=m("");let y=null;const P=()=>{c.value=60,y=setInterval(()=>{c.value>0?c.value-=1:clearInterval(y)},1e3)},O=s=>{w.value="",o.value[s]=o.value[s].replace(/[^0-9]/g,""),o.value[s]&&s<d-1&&u(()=>{r.value[s+1].focus()})},E=(s,e)=>{s.key==="Backspace"&&!o.value[e]&&e>0&&(o.value[e-1]="",u(()=>{r.value[e-1].focus()})),s.key==="ArrowLeft"&&e>0&&u(()=>{r.value[e-1].focus()}),s.key==="ArrowRight"&&e<d-1&&u(()=>{r.value[e+1].focus()})},B=s=>{s.preventDefault();const e=s.clipboardData.getData("text").trim();if(/^\d+$/.test(e)){e.split("").slice(0,d).forEach((a,T)=>{T<d&&(o.value[T]=a)});const i=o.value.findIndex(a=>!a);i!==-1?u(()=>{r.value[i].focus()}):u(()=>{r.value[d-1].focus()})}else f.error("Please paste a numeric OTP only")},D=async()=>{const s=o.value.join("");if(s.length!==d){f.error("Please enter all digits of the OTP");return}if(!g.value){f.error("Email is missing. Please go back to login."),v.push("/auth/password/forgot");return}const e=await p.verifyOtp({otp:s,email:g.value,label:h.value});if(!e.success){f.error(e.message);return}h.value==="reset_password"?v.push({name:"ResetPassword"}):v.push({name:"Home"})},A=async()=>{if(!g.value){f.error("Email is missing. Please go back to login."),v.push("/auth/password/forgot");return}const s=await p.sendOtp({email:g.value,label:h.value});if(!s.success){f.error(s.message);return}P()},L=()=>{v.push({name:"Login"})};return H(()=>{u(()=>{r.value[0]&&r.value[0].focus(),P()})}),N(()=>{y&&clearInterval(y)}),(s,e)=>(n(),l("div",Q,[t("div",W,[(n(),l(I,null,M(20,b=>t("div",{key:b,class:"absolute",style:K({left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,transform:`rotate(${Math.random()*360}deg)`})},[t("div",X,k(["⬠","⬡","◯","◫","◪","△","▽","◇","❖","✧","✦"][Math.floor(Math.random()*11)]),1)],4)),64))]),e[7]||(e[7]=$('<div class="mt-16 mb-8"><div class="flex items-center"><div class="text-6xl font-bold"><span class="text-orange-500">H</span><span class="text-purple-700">IMP</span><span class="text-blue-700">RI</span></div></div><div class="text-gray-600 italic text-center mt-1">LET THE GAME BEGIN</div></div>',1)),t("div",Y,[e[4]||(e[4]=t("h1",{class:"text-4xl font-bold text-center text-gray-800 mb-2"},"Verify OTP",-1)),e[5]||(e[5]=t("p",{class:"text-xl text-center text-gray-700 mb-8"},"Please enter the OTP sent to your email, check Spam Folder also.",-1)),t("form",{onSubmit:j(D,["prevent"])},[t("div",Z,[t("div",ee,[(n(!0),l(I,null,M(o.value,(b,i)=>U((n(),l("input",{key:i,"onUpdate:modelValue":a=>o.value[i]=a,type:"text",maxlength:"1",onInput:a=>O(i),onKeydown:a=>E(a,i),onPaste:e[0]||(e[0]=a=>B(a)),ref_for:!0,ref_key:"otpInputs",ref:r,class:"w-12 h-16 text-center text-2xl font-bold bg-gray-200 rounded-xl text-gray-700 focus:outline-none focus:ring-2 focus:ring-orange-400"},null,40,te)),[[G,o.value[i]]])),128))]),w.value?(n(),l("p",se,k(w.value),1)):F("",!0)]),t("button",{type:"submit",class:V(["w-full bg-orange-400 hover:bg-orange-500 text-white py-4 px-6 rounded-full text-xl font-bold transition duration-300",{"opacity-75 cursor-not-allowed":_(p).loading}]),disabled:_(p).loading},[_(p).loading?(n(),l("div",ae,e[1]||(e[1]=[t("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),C(" Verifying... ")]))):(n(),l("span",le,"Verify OTP"))],10,oe)],32),t("div",ne,[e[3]||(e[3]=t("p",{class:"text-gray-600"},"Didn't receive the code?",-1)),t("button",{onClick:A,class:V(["mt-2 text-orange-500 font-bold",{"opacity-50 cursor-not-allowed":x.value||c.value>0}]),disabled:x.value||c.value>0},[x.value?(n(),l("div",ie,e[2]||(e[2]=[t("svg",{class:"animate-spin -ml-1 mr-1 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),C(" Sending... ")]))):c.value>0?(n(),l("span",ce,"Resend in "+k(c.value)+"s",1)):(n(),l("span",ue,"Resend OTP"))],10,re)])]),t("div",{onClick:L,class:"mt-8 mb-12 text-white text-lg cursor-pointer"},e[6]||(e[6]=[t("span",{class:"text-orange-400 font-bold"},"← Back to Login",-1)]))]))}};export{pe as default};
